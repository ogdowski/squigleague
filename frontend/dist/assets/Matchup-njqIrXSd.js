import{f as d,l as M,c as r,h as v,b as e,t as o,n as f,i as P,v as S,e as $,g as B,j as _,q as D,o as i}from"./index-CRTPRc-Y.js";const T={class:"max-w-4xl mx-auto"},V={key:0,class:"text-center py-12"},q={key:1,class:"card"},A={class:"bg-red-900/30 border border-red-500 text-red-200 px-4 py-3 rounded"},E={key:2},F={class:"card mb-6"},N={class:"flex items-center justify-between mb-4"},R={class:"text-3xl font-bold"},W={class:"text-sm text-gray-400"},j={class:"grid md:grid-cols-2 gap-4 mb-6"},C={class:"bg-gray-900 p-4 rounded"},U={class:"bg-gray-900 p-4 rounded"},z={key:0,class:"card"},I={key:0,class:"bg-red-900/30 border border-red-500 text-red-200 px-4 py-3 rounded"},Y={key:1,class:"bg-green-900/30 border border-green-500 text-green-200 px-4 py-3 rounded"},G={key:0},H=["disabled"],J={key:1,class:"space-y-6"},K={class:"card"},O={class:"mb-8"},Q={class:"bg-gray-900 p-6 rounded text-center"},X={class:"text-3xl font-bold"},Z={class:"grid md:grid-cols-2 gap-6"},ee={class:"bg-gray-900 p-4 rounded"},te={class:"whitespace-pre-wrap font-mono text-sm text-gray-300"},se={class:"bg-gray-900 p-4 rounded"},ae={class:"whitespace-pre-wrap font-mono text-sm text-gray-300"},re={__name:"Matchup",setup(le){const b="/api",y=D(),g=d(!0),n=d(""),a=d(null),u=d(null),c=d(""),m=d(!1),p=d(""),x=d(!1),h=async()=>{var s,t;try{const l=await _.get(`${b}/matchup/${y.params.name}`);a.value=l.data,l.data.is_revealed&&await w()}catch(l){((s=l.response)==null?void 0:s.status)===404?n.value="Matchup not found":((t=l.response)==null?void 0:t.status)===410?n.value="This matchup has expired":n.value="Failed to load matchup"}finally{g.value=!1}},w=async()=>{try{const s=await _.get(`${b}/matchup/${y.params.name}/reveal`);u.value=s.data}catch(s){console.error("Failed to fetch reveal:",s)}},L=async()=>{var s,t;p.value="",x.value=!1,m.value=!0;try{const l=await _.post(`${b}/matchup/${y.params.name}/submit`,{army_list:c.value});x.value=!0,c.value="",l.data.is_revealed?await h():a.value.player1_submitted=!0}catch(l){p.value=((t=(s=l.response)==null?void 0:s.data)==null?void 0:t.detail)||"Failed to submit list"}finally{m.value=!1}},k=s=>new Date(s).toLocaleString();return M(()=>{h()}),(s,t)=>(i(),r("div",T,[g.value?(i(),r("div",V,[...t[1]||(t[1]=[e("p",{class:"text-xl text-gray-300"},"Loading matchup...",-1)])])):n.value?(i(),r("div",q,[e("div",A,o(n.value),1)])):a.value?(i(),r("div",E,[e("div",F,[e("div",N,[e("h1",R,"Matchup: "+o(a.value.name),1),e("span",W," Expires: "+o(k(a.value.expires_at)),1)]),e("div",j,[e("div",C,[t[2]||(t[2]=e("h3",{class:"font-bold mb-2"},"Player 1",-1)),e("p",{class:f(a.value.player1_submitted?"text-green-400":"text-gray-400")},o(a.value.player1_submitted?"✓ List submitted":"○ Waiting for list"),3)]),e("div",U,[t[3]||(t[3]=e("h3",{class:"font-bold mb-2"},"Player 2",-1)),e("p",{class:f(a.value.player2_submitted?"text-green-400":"text-gray-400")},o(a.value.player2_submitted?"✓ List submitted":"○ Waiting for list"),3)])])]),a.value.is_revealed?(i(),r("div",J,[e("div",K,[t[11]||(t[11]=e("div",{class:"bg-green-900/30 border border-green-500 text-green-200 px-4 py-3 rounded mb-6"}," Both lists have been submitted! The matchup is revealed. ",-1)),e("div",O,[t[8]||(t[8]=e("h2",{class:"text-2xl font-bold mb-4 text-squig-yellow"},"Map Assignment",-1)),e("div",Q,[e("p",X,o(u.value.map_name),1)])]),e("div",Z,[e("div",null,[t[9]||(t[9]=e("h3",{class:"text-xl font-bold mb-3"},"Player 1 List",-1)),e("div",ee,[e("pre",te,o(u.value.player1_list),1)])]),e("div",null,[t[10]||(t[10]=e("h3",{class:"text-xl font-bold mb-3"},"Player 2 List",-1)),e("div",se,[e("pre",ae,o(u.value.player2_list),1)])])])])])):(i(),r("div",z,[t[6]||(t[6]=e("div",{class:"mb-6"},[e("div",{class:"bg-blue-900/30 border border-blue-500 text-blue-200 px-4 py-3 rounded"}," Player 1 has submitted their army list. Submit yours to reveal both lists and the mission! ")],-1)),t[7]||(t[7]=e("h2",{class:"text-2xl font-bold mb-4"},"Submit Your Army List",-1)),e("form",{onSubmit:B(L,["prevent"]),class:"space-y-4"},[e("div",null,[t[4]||(t[4]=e("label",{class:"block text-sm font-medium mb-2"}," Paste your army list here ",-1)),P(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=l=>c.value=l),rows:"15",class:"input-field w-full font-mono text-sm",placeholder:"Paste your army list here...",required:""},null,512),[[S,c.value]])]),p.value?(i(),r("div",I,o(p.value),1)):v("",!0),x.value?(i(),r("div",Y,[t[5]||(t[5]=$(" List submitted successfully! ",-1)),a.value.is_revealed?v("",!0):(i(),r("span",G,"Waiting for reveal..."))])):v("",!0),e("button",{type:"submit",disabled:m.value,class:"btn-primary w-full"},o(m.value?"Submitting...":"Submit List"),9,H)],32)]))])):v("",!0)]))}};export{re as default};
