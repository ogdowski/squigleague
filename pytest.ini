[pytest]
# Pytest configuration for SquigLeague

# Python path - include backend directory for imports
pythonpath = backend

# Test discovery patterns
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Directories to search for tests
testpaths = backend/tests

# Markers for categorizing tests
markers =
    unit: Unit tests (fast, isolated functions)
    integration: Integration tests (real database, API)
    slow: Tests that take longer than 1 second

# Coverage configuration
addopts =
    # Verbose output
    -v
    # Show summary of all test outcomes
    -ra
    # Show local variables in tracebacks
    --showlocals
    # Strict markers (fail on unknown markers)
    --strict-markers
    # Strict config (fail on config issues)
    --strict-config
    # Enable coverage by default (can be disabled with --no-cov)
    --cov=backend/app
    # Coverage report format
    --cov-report=term-missing
    --cov-report=html
    --cov-report=xml
    # Fail if coverage is below 40%
    --cov-fail-under=40
    # Show warning summary
    -Wd

# Minimum Python version
minversion = 3.9

# Console output style
console_output_style = progress

# Warnings
filterwarnings =
    # Ignore deprecation warnings
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning

# Coverage exclusions
[coverage:run]
# Use relative file paths for CI compatibility
relative_files = true

omit =
    # Test files themselves
    backend/tests/*
    # Virtual environment
    .venv/*
    venv/*
    # Configuration files
    */conftest.py

[coverage:report]
# Show missing lines in terminal report
show_missing = true

# Exclude patterns
exclude_lines =
    # Exclude pragma comments
    pragma: no cover
    # Exclude if TYPE_CHECKING blocks
    if TYPE_CHECKING:
    # Exclude NotImplementedError
    raise NotImplementedError
    # Exclude pass statements
    pass

# Precision for coverage percentage
precision = 2

[coverage:html]
# HTML report output directory
directory = htmlcov

[coverage:xml]
# XML report output file
output = coverage.xml
