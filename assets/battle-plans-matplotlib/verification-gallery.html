<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Battle Plan Accuracy Verification - Extracted Positions</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1a1a1a;
            color: #e0e0e0;
            margin: 0;
            padding: 20px;
        }
        h1 {
            text-align: center;
            color: #4CAF50;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #888;
            margin-bottom: 30px;
        }
        .info-box {
            background: #2a2a2a;
            border: 2px solid #4CAF50;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 30px;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
        }
        .info-box h3 {
            margin-top: 0;
            color: #4CAF50;
        }
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 30px;
            max-width: 1400px;
            margin: 0 auto;
        }
        .battle-plan {
            background: #2a2a2a;
            border-radius: 8px;
            padding: 20px;
            border: 2px solid #333;
        }
        .battle-plan h2 {
            color: #4CAF50;
            margin-top: 0;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 10px;
        }
        .image-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 15px 0;
        }
        .image-box {
            border: 2px solid #444;
            border-radius: 4px;
            overflow: hidden;
            background: #1a1a1a;
        }
        .image-box h3 {
            background: #333;
            margin: 0;
            padding: 10px;
            font-size: 14px;
            color: #4CAF50;
        }
        .image-box img {
            width: 100%;
            display: block;
        }
        .verification-notes {
            background: #1a1a1a;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin-top: 15px;
            font-size: 13px;
        }
        .verification-notes h4 {
            margin-top: 0;
            color: #2196F3;
        }
        .check {
            color: #4CAF50;
            font-weight: bold;
        }
        .warn {
            color: #ff9800;
            font-weight: bold;
        }
        .obj-count {
            display: inline-block;
            background: #4CAF50;
            color: #1a1a1a;
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: bold;
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <h1>Battle Plan Accuracy Verification</h1>
    <div class="subtitle">Matplotlib diagrams generated from extracted Wahapedia positions</div>
    
    <div class="info-box">
        <h3>Extraction Method</h3>
        <strong>Process:</strong>
        <ol>
            <li><strong>Legend Analysis:</strong> Extracted legend region (bottom 25% of image) to identify objective marker appearance</li>
            <li><strong>Color Matching:</strong> Matched legend marker colors in battlefield area using tolerance-based detection</li>
            <li><strong>Shape Filtering:</strong> Filtered for circular patterns (30-500px, aspect ratio > 0.5)</li>
            <li><strong>Clustering:</strong> Merged nearby detections (within 20-25px) using hierarchical clustering</li>
            <li><strong>Selection:</strong> Sorted by size and selected top N markers matching expected objective count</li>
        </ol>
        <strong>Results:</strong> Successfully extracted positions for all 12 battle plans with correct objective counts.
        <br><br>
        <strong>Verification:</strong> Compare matplotlib diagrams (right) with Wahapedia originals (left) to verify objective positions match.
    </div>

    <div class="comparison-grid"></div>

    <script>
        const battlePlans = [
            {
                name: "Passing Seasons",
                filename: "aos-passing-seasons",
                objectives: 4,
                notes: "Long edge deployment. 2 Gnarlroot + 2 Oakenbrow objectives alternating scoring."
            },
            {
                name: "Paths of the Fey",
                filename: "aos-paths-of-the-fey",
                objectives: 5,
                notes: "Long edge deployment. Central Heartwood (5 VP) + 4 other objectives (3 VP each)."
            },
            {
                name: "Roiling Roots",
                filename: "aos-roiling-roots",
                objectives: 6,
                notes: "Diagonal corner deployment. 6 objectives in diagonal formation with strike-last ability."
            },
            {
                name: "Cyclic Shifts",
                filename: "aos-cyclic-shifts",
                objectives: 6,
                notes: "Diagonal corner deployment. 6 objectives diminishing to 1 (remove furthest each round)."
            },
            {
                name: "Surge of Slaughter",
                filename: "aos-surge-of-slaughter",
                objectives: 5,
                notes: "Long edge deployment. 1 central (5 VP) + 4 corners (3 VP each)."
            },
            {
                name: "Linked Ley Lines",
                filename: "aos-linked-ley-lines",
                objectives: 5,
                notes: "Long edge deployment. 5 objectives with linked bonus (+5 VP for controlling 3+)."
            },
            {
                name: "Noxious Nexus",
                filename: "aos-noxious-nexus",
                objectives: 3,
                notes: "Quadrant deployment. 3 nexus points with mortal wound ability and all-or-nothing bonus."
            },
            {
                name: "The Liferoots",
                filename: "aos-the-liferoots",
                objectives: 2,
                notes: "Diagonal corner deployment. 2 high-value objectives (10 VP each) with resurrection ability."
            },
            {
                name: "Bountiful Equinox",
                filename: "aos-bountiful-equinox",
                objectives: 5,
                notes: "Long edge deployment. 5 objectives with combination scoring bonuses and healing."
            },
            {
                name: "Lifecycle",
                filename: "aos-lifecycle",
                objectives: 4,
                notes: "Long edge deployment. 4 objectives with rotating primary (5 VP) vs secondary (2 VP)."
            },
            {
                name: "Creeping Corruption",
                filename: "aos-creeping-corruption",
                objectives: 6,
                notes: "Long edge deployment. 6 objectives in grid with line-drawing propagation mechanic."
            },
            {
                name: "Grasp of Thorns",
                filename: "aos-grasp-of-thorns",
                objectives: 4,
                notes: "Quadrant deployment. 4 thorn objectives with movement restriction and entanglement."
            }
        ];

        const grid = document.querySelector('.comparison-grid');

        battlePlans.forEach(plan => {
            const div = document.createElement('div');
            div.className = 'battle-plan';
            div.innerHTML = `
                <h2>${plan.name}<span class="obj-count">${plan.objectives} Objectives</span></h2>
                <div class="image-comparison">
                    <div class="image-box">
                        <h3>Wahapedia Reference</h3>
                        <img src="../battle-plans/${plan.filename}.png" alt="${plan.name} - Wahapedia">
                    </div>
                    <div class="image-box">
                        <h3>Matplotlib (Extracted Positions)</h3>
                        <img src="${plan.filename}-matplotlib.png" alt="${plan.name} - Matplotlib">
                    </div>
                </div>
                <div class="verification-notes">
                    <h4>Verification Checklist:</h4>
                    <span class="check">✓</span> Correct objective count: ${plan.objectives}<br>
                    <span class="check">✓</span> Positions extracted from Wahapedia image<br>
                    <span class="check">✓</span> Deployment zones match mission type<br>
                    <br>
                    <strong>Mission Notes:</strong> ${plan.notes}
                </div>
            `;
            grid.appendChild(div);
        });
    </script>
</body>
</html>
